name: yieldops-api
service:
  type: web
  ports:
    - port: 8000
      protocol: http
  routes:
    - path: /
  command: uvicorn app.main:app --host 0.0.0.0 --port 8000
  root_directory: apps/api
  env:
    - name: SUPABASE_URL
      value: "SET_IN_KOYEB_DASHBOARD"
    - name: SUPABASE_ANON_KEY
      value: "SET_IN_KOYEB_DASHBOARD"
    - name: SUPABASE_SERVICE_KEY
      value: "SET_IN_KOYEB_DASHBOARD"
    - name: CORS_ALLOW_ORIGINS
      value: "https://yield-ops-dashboard.vercel.app,https://yieldops.vercel.app,https://yieldops-dashboard.vercel.app,http://localhost:5173,http://localhost:3000"
    - name: CORS_ALLOW_ORIGIN_REGEX
      value: "https://.*yield[-_]?ops[-_]?dashboard.*\\.vercel\\.app"
    - name: PORT
      value: "8000"
    - name: AUTO_INIT_MODEL
      value: "true"
  instance_type: nano
  scaling:
    min: 1
    max: 1
  healthcheck:
    http:
      port: 8000
      path: /health
  skip_cache: true
